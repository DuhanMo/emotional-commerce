# Loopers Kotlin Commerce Project λ¶„μ„

## π“‹ ν”„λ΅μ νΈ κ°μ”

**Loopers Template** - Spring Boot + Kotlin κΈ°λ° E-commerce API ν”„λ΅μ νΈ

- **ν”„λ΅μ νΈλ…**: emotional-commerce
- **ν…ν”λ¦Ώ**: Loopersμ—μ„ μ κ³µν•λ” Spring Boot + Kotlin ν‘μ¤€ ν…ν”λ¦Ώ
- **μ•„ν‚¤ν…μ²**: DDD κΈ°λ° ν—¥μ‚¬κ³ λ‚  μ•„ν‚¤ν…μ² (ν¬νΈ & μ–΄λ‘ν„°)
- **λΉλ“ λ„κµ¬**: Gradle (Kotlin DSL)
- **μ–Έμ–΄**: Kotlin + Java 21

## π—οΈ μ•„ν‚¤ν…μ² λ° κ³„μΈµκµ¬μ΅°

### μ „μ²΄ μ•„ν‚¤ν…μ²

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚              Interfaces Layer               β”‚ β† REST API, Controllers
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚             Application Layer               β”‚ β† Use Cases, Facades
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚               Domain Layer                  β”‚ β† Business Logic, Entities
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚            Infrastructure Layer             β”‚ β† Database, External APIs
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

### λ©€ν‹°λ¨λ“ κµ¬μ΅°

```
Root
β”β”€β”€ apps (μ‹¤ν–‰ μ• ν”λ¦¬μΌ€μ΄μ…)
β”‚   β””β”€β”€ π“¦ commerce-api - E-commerce REST API
β”β”€β”€ modules (μ¬μ‚¬μ© κ°€λ¥ν• μ„¤μ •)
β”‚   β””β”€β”€ π“¦ jpa - JPA κ³µν†µ μ„¤μ •, BaseEntity
β””β”€β”€ supports (λ¶€κ°€κΈ°λ¥ μ• λ“μ¨)
    β”β”€β”€ π“¦ jackson - JSON μ§λ ¬ν™” μ„¤μ •
    β”β”€β”€ π“¦ logging - λ΅κΉ… μ„¤μ • (Slack μ—°λ™)
    β””β”€β”€ π“¦ monitoring - λ©”νΈλ¦­μ¤, νΈλ μ΄μ‹± (Prometheus, Grafana)
```

### κ³„μΈµλ³„ μƒμ„Έ κµ¬μ΅°

#### π― Domain Layer (λ„λ©”μΈ κ³„μΈµ)

**ν•µμ‹¬ λΉ„μ¦λ‹μ¤ λ΅μ§, μΈν”„λΌμ— λ…λ¦½μ **

- **μ—”ν‹°ν‹° (Entities)**:
    - `User` - μ‚¬μ©μ μ •λ³΄ (λ΅κ·ΈμΈID, μ΄λ©”μΌ, μƒλ…„μ›”μΌ, μ„±λ³„)
    - `Product` - μƒν’ μ •λ³΄ (λΈλλ“, μ΄λ¦„, κ°€κ²©, μ¬κ³ )
    - `Point` - ν¬μΈνΈ μ •λ³΄ (μ‚¬μ©μλ³„ λ³΄μ  ν¬μΈνΈ)
    - `Brand` - λΈλλ“ μ •λ³΄
    - `ProductLike` - μƒν’ μΆ‹μ•„μ”
    - `ProductSummary` - μƒν’ μ§‘κ³„ μ •λ³΄ (μΆ‹μ•„μ” μ)

- **κ°’ κ°μ²΄ (Value Objects)**:
    - `LoginId`, `Email`, `BirthDate`, `Gender` - μ‚¬μ©μ κ΄€λ ¨
    - `ProductInfo`, `ProductLikeStatus` - μƒν’ κ΄€λ ¨

- **λ„λ©”μΈ μ„λΉ„μ¤**:
    - `*QueryService` - μ΅°ν μ „μ© μ„λΉ„μ¤
    - `*WriteService` - λ³€κ²½ μ „μ© μ„λΉ„μ¤
    - `*Service` - λΉ„μ¦λ‹μ¤ λ΅μ§ μ„λΉ„μ¤

- **λ¦¬ν¬μ§€ν† λ¦¬ μΈν„°νμ΄μ¤**: λ°μ΄ν„° μ ‘κ·Ό μ¶”μƒν™”

#### π€ Application Layer (μ• ν”λ¦¬μΌ€μ΄μ… κ³„μΈµ)

**μ μ¤μΌ€μ΄μ¤ μ¤μΌ€μ¤νΈλ μ΄μ…**

- **Facade ν¨ν„΄μΌλ΅ κµ¬ν„**:
    - `UserFacade` - νμ›κ°€μ…, λ‚΄ μ •λ³΄ μ΅°ν
    - `ProductFacade` - μƒν’ μΆ‹μ•„μ”/μ·¨μ†
    - `ProductQueryFacade` - μƒν’ λ©λ΅/μƒμ„Έ μ΅°ν
    - `PointFacade` - ν¬μΈνΈ μ¶©μ „/μ΅°ν

- **Input/Output DTO**: κ³„μΈµκ°„ λ°μ΄ν„° μ „μ†΅
- **νΈλμ­μ… κ²½κ³„**: `@Transactional` κ΄€λ¦¬

#### π”§ Infrastructure Layer (μΈν”„λΌμ¤νΈλ­μ² κ³„μΈµ)

**μ™Έλ¶€ μ‹μ¤ν…κ³Όμ μ—°λ™**

- **JPA Repository κµ¬ν„μ²΄**:
    - `*RepositoryImpl` - λ„λ©”μΈ λ¦¬ν¬μ§€ν† λ¦¬ μΈν„°νμ΄μ¤ κµ¬ν„
    - `*JpaRepository` - Spring Data JPA μΈν„°νμ΄μ¤

- **BaseEntity**: κ³µν†µ μ—”ν‹°ν‹° κΈ°λ¥
    - μƒμ„±/μμ •/μ‚­μ  μ‹κ°„ μλ™ κ΄€λ¦¬
    - Soft Delete μ§€μ› (`deletedAt`)
    - μ—”ν‹°ν‹° κ²€μ¦ (`guard()` λ©”μ„λ“)

#### π Interfaces Layer (μΈν„°νμ΄μ¤ κ³„μΈµ)

**μ™Έλ¶€μ™€μ μ ‘μ **

- **REST API Controllers**:
    - `UserV1Controller` - μ‚¬μ©μ κ΄€λ ¨ API
    - `ProductV1Controller` - μƒν’ κ΄€λ ¨ API
    - `PointV1Controller` - ν¬μΈνΈ κ΄€λ ¨ API
    - `LikeV1Controller` - μƒν’ μΆ‹μ•„μ” API

- **ν†µμΌλ μ‘λ‹µ ν•μ‹**: `ApiResponse<T>` λνΌ
- **μ „μ—­ μμ™Έ μ²λ¦¬**: `ApiControllerAdvice`
- **API λ¬Έμ„ν™”**: SpringDoc OpenAPI μλ™ μƒμ„±

## π› οΈ κΈ°μ  μ¤νƒ

### ν”„λ μ„μ›ν¬

- **Spring Boot** - μ›Ή μ• ν”λ¦¬μΌ€μ΄μ… ν”„λ μ„μ›ν¬
- **Spring Data JPA** - λ°μ΄ν„° μ ‘κ·Ό κ³„μΈµ
- **Spring Validation** - μ…λ ¥ λ°μ΄ν„° κ²€μ¦

### λ°μ΄ν„°λ² μ΄μ¤

- **MySQL** - λ©”μΈ λ°μ΄ν„°λ² μ΄μ¤
- **Kotlin JDSL** - QueryDSL λ€μ• (νƒ€μ… μ„Έμ΄ν”„ μΏΌλ¦¬)

### ν…μ¤νΈ

- **Kotest** - Kotlin ν…μ¤νΈ ν”„λ μ„μ›ν¬
- **Testcontainers** - ν†µν•© ν…μ¤νΈμ© μ»¨ν…μ΄λ„
- **SpringMockK** - Kotlinμ© λ¨ν‚Ή λΌμ΄λΈλ¬λ¦¬

### λ¨λ‹ν„°λ§ & λ΅κΉ…

- **Prometheus** - λ©”νΈλ¦­ μμ§‘
- **Grafana** - λ©”νΈλ¦­ μ‹κ°ν™”
- **Logback** - λ΅κΉ… ν”„λ μ„μ›ν¬
- **Slack Appender** - Slack λ΅κ·Έ μ•λ¦Ό

### κΈ°νƒ€

- **Jackson** - JSON μ§λ ¬ν™”/μ—­μ§λ ¬ν™”
- **ktlint** - Kotlin μ½”λ“ μ¤νƒ€μΌ
- **pre-commit** - μ»¤λ°‹ μ „ μ½”λ“ κ²€μ¦

## β΅ μ£Όμ” κΈ°λ¥

### 1. μ‚¬μ©μ κ΄€λ¦¬

- **νμ›κ°€μ…**: ID/μ΄λ©”μΌ/μƒλ…„μ›”μΌ/μ„±λ³„ κ²€μ¦
- **λ‚΄ μ •λ³΄ μ΅°ν**: λ΅κ·ΈμΈ ID κΈ°λ° μ‚¬μ©μ μ •λ³΄ μ΅°ν

### 2. ν¬μΈνΈ μ‹μ¤ν…

- **ν¬μΈνΈ μ΅°ν**: ν„μ¬ λ³΄μ  ν¬μΈνΈ ν™•μΈ
- **ν¬μΈνΈ μ¶©μ „**: ν¬μΈνΈ μ¶©μ „ λ° λ΅κ·Έ κΈ°λ΅
- **ν¬μΈνΈ λ΅κ·Έ**: μ¶©μ „/μ‚¬μ© μ΄λ ¥ μ¶”μ 

### 3. μƒν’ κ΄€λ¦¬

- **μƒν’ λ©λ΅ μ΅°ν**: λΈλλ“ ν•„ν„°λ§, μ •λ ¬ μ§€μ› (μµμ‹ μ, κ°€κ²©μ, μΆ‹μ•„μ”μ)
- **μƒν’ μƒμ„Έ μ΅°ν**: κ°λ³„ μƒν’ μ •λ³΄ μ΅°ν
- **λΈλλ“ μ •λ³΄**: λΈλλ“ μƒμ„Έ μ •λ³΄ μ΅°ν

### 4. μƒν’ μΆ‹μ•„μ”

- **μΆ‹μ•„μ” λ“±λ΅/μ·¨μ†**: λ΅κ·ΈμΈ μ‚¬μ©μ λ€μƒ
- **μΆ‹μ•„μ”ν• μƒν’ λ©λ΅**: λ‚΄κ°€ μΆ‹μ•„μ”ν• μƒν’ μ΅°ν
- **μΆ‹μ•„μ” μ μ§‘κ³„**: ProductSummaryλ¥Ό ν†µν• μ‹¤μ‹κ°„ μ§‘κ³„

## π¨ μ„¤κ³„ ν¨ν„΄ λ° μ›μΉ™

### μ μ©λ ν¨ν„΄

- **Repository ν¨ν„΄**: λ°μ΄ν„° μ ‘κ·Ό μ¶”μƒν™”
- **Facade ν¨ν„΄**: λ³µμ΅ν• μ„λΈμ‹μ¤ν… λ‹¨μν™”
- **Value Object ν¨ν„΄**: λ„λ©”μΈ κ°λ… ν‘ν„
- **CQRS**: Query/Write μ„λΉ„μ¤ λ¶„λ¦¬

### μ„¤κ³„ μ›μΉ™

- **μμ΅΄μ„± μ—­μ „**: Domainμ΄ Infrastructureμ— μμ΅΄ν•μ§€ μ•μ
- **λ‹¨μΌ μ±…μ„**: κ° κ³„μΈµλ³„ λ…ν™•ν• μ—­ν•  λ¶„λ¦¬
- **λ„λ©”μΈ μ¤‘μ‹¬**: λΉ„μ¦λ‹μ¤ λ΅μ§μ„ Domain Layerμ— μ§‘μ¤‘

## π”„ μμ΅΄μ„± νλ¦„

```
Controller β†’ Facade β†’ DomainService β†’ Repository(Interface)
    β†“           β†“           β†“              β†‘
Interfaces  Application  Domain    Infrastructure
                                   (RepositoryImpl)
```

## π§ ν…μ¤νΈ μ „λµ

### ν…μ¤νΈ κ³„μΈµ

- **λ‹¨μ„ ν…μ¤νΈ**: λ„λ©”μΈ κ°μ²΄ κ²€μ¦ λ΅μ§
- **ν†µν•© ν…μ¤νΈ**: μ„λΉ„μ¤ κ³„μΈµ ν…μ¤νΈ (with TestContainers)
- **E2E ν…μ¤νΈ**: API μ—”λ“ν¬μΈνΈ ν…μ¤νΈ

### ν…μ¤νΈ λ…λ… κ·μΉ™

- `*Test.kt` - λ‹¨μ„ ν…μ¤νΈ
- `*IGTest.kt` - ν†µν•© ν…μ¤νΈ (Integration Test)
- `*E2ETest.kt` - E2E ν…μ¤νΈ

## π“ ν–¥ν›„ κ°λ° κ³„ν

### Phase 1 (ν„μ¬ κµ¬ν„ μ™„λ£)

- β… μ‚¬μ©μ κ΄€λ¦¬ (νμ›κ°€μ…, μ΅°ν)
- β… ν¬μΈνΈ μ‹μ¤ν… (μ¶©μ „, μ΅°ν)
- β… μƒν’ κ΄€λ¦¬ (λ©λ΅, μƒμ„Έ, λΈλλ“)
- β… μƒν’ μΆ‹μ•„μ” κΈ°λ¥

### Phase 2 (κ³„ν)

- π”„ μ£Όλ¬Έ μ‹μ¤ν… κµ¬ν„
- π”„ κ²°μ  μ‹μ¤ν… (ν¬μΈνΈ κ²°μ )
- π”„ μ¬κ³  κ΄€λ¦¬ μ‹μ¤ν…
- π”„ λ°°μ†΅μ§€ κ΄€λ¦¬

## π€ κ°λ° ν™κ²½ μ„¤μ •

### ν•„μ μ„¤μΉ

```bash
# ν”„λ΅μ νΈ μ΄κΈ° μ„¤μ •
make init

# κ°λ° μΈν”„λΌ μ‹¤ν–‰
docker-compose -f ./docker/infra-compose.yml up

# λ¨λ‹ν„°λ§ ν™κ²½ μ‹¤ν–‰
docker-compose -f ./docker/monitoring-compose.yml up
```

### λ¨λ‹ν„°λ§ μ ‘μ†

- **Grafana**: http://localhost:3000 (admin/admin)
- **Application**: μ‹¤ν–‰ ν›„ actuator μ—”λ“ν¬μΈνΈ ν™μ©

## π“ μ£Όμ” νμΌ κµ¬μ΅°

```
apps/commerce-api/src/main/kotlin/com/loopers/
β”β”€β”€ application/          # μ• ν”λ¦¬μΌ€μ΄μ… κ³„μΈµ
β”‚   β”β”€β”€ user/            # μ‚¬μ©μ μ μ¤μΌ€μ΄μ¤
β”‚   β”β”€β”€ product/         # μƒν’ μ μ¤μΌ€μ΄μ¤
β”‚   β””β”€β”€ point/           # ν¬μΈνΈ μ μ¤μΌ€μ΄μ¤
β”β”€β”€ domain/              # λ„λ©”μΈ κ³„μΈµ
β”‚   β”β”€β”€ user/            # μ‚¬μ©μ λ„λ©”μΈ
β”‚   β”β”€β”€ product/         # μƒν’ λ„λ©”μΈ
β”‚   β”β”€β”€ point/           # ν¬μΈνΈ λ„λ©”μΈ
β”‚   β””β”€β”€ brand/           # λΈλλ“ λ„λ©”μΈ
β”β”€β”€ infrastructure/      # μΈν”„λΌ κ³„μΈµ
β”‚   β”β”€β”€ user/            # μ‚¬μ©μ μ €μ¥μ† κµ¬ν„
β”‚   β”β”€β”€ product/         # μƒν’ μ €μ¥μ† κµ¬ν„
β”‚   β””β”€β”€ point/           # ν¬μΈνΈ μ €μ¥μ† κµ¬ν„
β””β”€β”€ interfaces/          # μΈν„°νμ΄μ¤ κ³„μΈµ
    β””β”€β”€ api/             # REST API
        β”β”€β”€ user/        # μ‚¬μ©μ API
        β”β”€β”€ product/     # μƒν’ API
        β”β”€β”€ point/       # ν¬μΈνΈ API
        β””β”€β”€ like/        # μΆ‹μ•„μ” API
```

---

*μ΄ λ¬Έμ„λ” ν”„λ΅μ νΈ λ¶„μ„μ„ ν†µν•΄ μλ™ μƒμ„±λμ—μµλ‹λ‹¤.*